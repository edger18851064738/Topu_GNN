<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è½¦è¾†è½¨è¿¹å¯è§†åŒ–</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 28px;
        }
        .chart-container {
            position: relative;
            height: 600px;
            margin-bottom: 30px;
        }
        .info-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        .vehicle-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #007bff;
        }
        .vehicle-info.vehicle-1007 {
            border-left-color: #dc3545;
        }
        .vehicle-info h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        .stats {
            background: #e8f5e8;
            padding: 20px;
            border-radius: 10px;
            grid-column: 1 / -1;
            border-left: 5px solid #28a745;
        }
        .coordinate {
            font-family: 'Courier New', monospace;
            background: #f1f3f4;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 14px;
        }
        .timestamp {
            color: #6c757d;
            font-size: 12px;
            margin-top: 5px;
        }
        .legend-item {
            display: inline-flex;
            align-items: center;
            margin-right: 20px;
            margin-bottom: 10px;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .legend-square {
            width: 20px;
            height: 20px;
            margin-right: 8px;
        }
        .legend-triangle {
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-bottom: 20px solid;
            margin-right: 8px;
        }
        .direction-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 2px solid #dee2e6;
        }
        .intersection-highlight {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš— è½¦è¾†1010å’Œ1007è½¨è¿¹å¯è§†åŒ–</h1>
        
        <div class="direction-legend">
            <div class="legend-item">
                <div class="legend-square" style="background-color: #4472C4;"></div>
                <span>ğŸ èµ·ç‚¹</span>
            </div>
            <div class="legend-item">
                <div class="legend-triangle" style="border-bottom-color: #4472C4;"></div>
                <span>ğŸ¯ ç»ˆç‚¹</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #4472C4;"></div>
                <span>â¡ï¸ è½¦è¾†1010è½¨è¿¹ (è¥¿å—â†’ä¸œåŒ—)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #E74C3C;"></div>
                <span>â¡ï¸ è½¦è¾†1007è½¨è¿¹ (ä¸œåŒ—â†’è¥¿å—)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #27AE60; border: 3px solid #fff; box-shadow: 0 0 0 2px #27AE60;"></div>
                <span>ğŸ”„ äº¤æ±‡ç‚¹</span>
            </div>
        </div>
        
        <div class="chart-container">
            <canvas id="trajectoryChart"></canvas>
        </div>
        
        <div class="info-panel">
            <div class="vehicle-info">
                <h3>ğŸš› è½¦è¾†1010 (è“è‰²è½¨è¿¹)</h3>
                <p><strong>æ€»è½¨è¿¹ç‚¹æ•°:</strong> 40ä¸ªç‚¹</p>
                <p><strong>ğŸ èµ·ç‚¹:</strong> <span class="coordinate">(33.85, -42.97)</span> ğŸ“</p>
                <p><strong>ğŸ¯ ç»ˆç‚¹:</strong> <span class="coordinate">(60.13, -13.87)</span> ğŸ”º</p>
                <p><strong>â¡ï¸ å‰è¿›æ–¹å‘:</strong> è¥¿å— â†’ ä¸œåŒ— (å³ä¸Šæ–¹å‘)</p>
                <p><strong>ğŸ“ è·¯å¾„ç‰¹å¾:</strong> ç›¸å¯¹ç›´çº¿ï¼Œè·ç¦»è¾ƒçŸ­</p>
                <p><strong>é‡‡æ ·ç‚¹:</strong></p>
                <ul>
                    <li>ğŸ [èµ·ç‚¹] <span class="coordinate">(33.85, -42.97)</span></li>
                    <li>âšª [20] <span class="coordinate">(47.31, -27.89)</span></li>
                    <li>ğŸ¯ [ç»ˆç‚¹] <span class="coordinate">(60.13, -13.87)</span></li>
                </ul>
                <div class="timestamp">â° æ—¶é—´æˆ³: 2025-06-25 11:20:59.111</div>
            </div>
            
            <div class="vehicle-info vehicle-1007">
                <h3>ğŸš› è½¦è¾†1007 (çº¢è‰²è½¨è¿¹)</h3>
                <p><strong>æ€»è½¨è¿¹ç‚¹æ•°:</strong> 74ä¸ªç‚¹</p>
                <p><strong>ğŸ èµ·ç‚¹:</strong> <span class="coordinate">(3.00, 0.64)</span> ğŸ“</p>
                <p><strong>ğŸ¯ ç»ˆç‚¹:</strong> <span class="coordinate">(33.85, -42.97)</span> ğŸ”º</p>
                <p><strong>â¡ï¸ å‰è¿›æ–¹å‘:</strong> ä¸œåŒ— â†’ è¥¿å— (å·¦ä¸‹æ–¹å‘)</p>
                <p><strong>ğŸ“ è·¯å¾„ç‰¹å¾:</strong> æ›²çº¿è·¯å¾„ï¼Œè·ç¦»è¾ƒé•¿ï¼Œå¤šæ¬¡è½¬å‘</p>
                <p><strong>é‡‡æ ·ç‚¹:</strong></p>
                <ul>
                    <li>ğŸ [èµ·ç‚¹] <span class="coordinate">(3.00, 0.64)</span></li>
                    <li>âšª [20] <span class="coordinate">(20.50, -6.88)</span></li>
                    <li>âšª [40] <span class="coordinate">(38.18, -13.32)</span></li>
                    <li>âšª [60] <span class="coordinate">(40.55, -32.00)</span></li>
                    <li>ğŸ¯ [ç»ˆç‚¹] <span class="coordinate">(33.85, -42.97)</span></li>
                </ul>
                <div class="timestamp">â° æ—¶é—´æˆ³: 2025-06-25 11:21:16.106</div>
            </div>
            
            <div class="stats">
                <h3>ğŸ“Š è½¨è¿¹åˆ†æç»“æœ</h3>
                <div class="intersection-highlight">
                    <strong>âš ï¸ å‘ç°äº¤æ±‡ç‚¹:</strong> è½¦è¾†1007çš„ç»ˆç‚¹ä¸è½¦è¾†1010çš„èµ·ç‚¹é‡åˆåœ¨åæ ‡ 
                    <span class="coordinate">(33.85, -42.97)</span> â­
                    <br><br>
                    <strong>ğŸ”„ äº¤æ¥åˆ†æ:</strong> è½¦è¾†1007å…ˆåˆ°è¾¾äº¤æ±‡ç‚¹ï¼Œ17ç§’åè½¦è¾†1010ä»è¯¥ç‚¹å‡ºå‘ï¼Œå½¢æˆå®Œç¾çš„æ¥åŠ›è¿è¾“ã€‚
                </div>
                <br>
                <p><strong>ğŸ§­ è·¯å¾„æ–¹å‘åˆ†æ:</strong></p>
                <ul>
                    <li><strong>è½¦è¾†1010:</strong> ğŸ”µ ä»è¥¿å—å‘ä¸œåŒ—æ–¹å‘è¡Œé©¶ (â†—ï¸)ï¼Œè·¯å¾„ç›¸å¯¹ç›´çº¿ï¼Œæ•ˆç‡è¾ƒé«˜</li>
                    <li><strong>è½¦è¾†1007:</strong> ğŸ”´ ä»ä¸œåŒ—å‘è¥¿å—æ–¹å‘è¡Œé©¶ (â†™ï¸)ï¼Œè·¯å¾„å‘ˆSå½¢æ›²çº¿ï¼Œç»è¿‡å¤šä¸ªå…³é”®ç‚¹</li>
                    <li><strong>ç©ºé—´å¸ƒå±€:</strong> ä¸¤è½¦è½¨è¿¹å½¢æˆä¸€ä¸ª"V"å­—å½¢è·¯å¾„ç½‘ç»œï¼Œäº¤æ±‡ç‚¹ä¸ºè½¬æŠ˜ä¸­å¿ƒ</li>
                    <li><strong>è¿è¡Œç‰¹ç‚¹:</strong> 1007å·è½¦è·¯å¾„æ›´å¤æ‚(74ç‚¹ vs 40ç‚¹)ï¼Œå¯èƒ½æ‰¿æ‹…æ›´å¤šç«™ç‚¹æœåŠ¡</li>
                </ul>
                <br>
                <p><strong>ğŸ¯ è§†è§‰æ ‡è¯†è¯´æ˜:</strong></p>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                    <div>ğŸ“ æ–¹å½¢ç‚¹ = èµ·ç‚¹</div>
                    <div>ğŸ¯ ä¸‰è§’å½¢ç‚¹ = ç»ˆç‚¹</div>
                    <div>âšª åœ†å½¢ç‚¹ = è·¯å¾„ç‚¹</div>
                    <div>â­ æ˜Ÿå½¢ç‚¹ = äº¤æ±‡ç‚¹</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // è½¦è¾†è½¨è¿¹æ•°æ®
        const vehicle1010StartPoint = [{x: 33.85, y: -42.97, label: 'èµ·ç‚¹', direction: 'å¼€å§‹å‘ä¸œåŒ—æ–¹å‘è¡Œé©¶'}];
        const vehicle1010MiddlePoints = [{x: 47.31, y: -27.89, label: 'é‡‡æ ·ç‚¹[20]', direction: 'ç»§ç»­å‘ä¸œåŒ—æ–¹å‘'}];
        const vehicle1010EndPoint = [{x: 60.13, y: -13.87, label: 'ç»ˆç‚¹', direction: 'åˆ°è¾¾ç›®çš„åœ°'}];
        
        const vehicle1007StartPoint = [{x: 3.00, y: 0.64, label: 'èµ·ç‚¹', direction: 'å¼€å§‹å‘è¥¿å—æ–¹å‘è¡Œé©¶'}];
        const vehicle1007MiddlePoints = [
            {x: 20.50, y: -6.88, label: 'é‡‡æ ·ç‚¹[20]', direction: 'å‘è¥¿å—æ–¹å‘'},
            {x: 38.18, y: -13.32, label: 'é‡‡æ ·ç‚¹[40]', direction: 'ç»§ç»­å‘è¥¿å—'},
            {x: 40.55, y: -32.00, label: 'é‡‡æ ·ç‚¹[60]', direction: 'æ¥è¿‘äº¤æ±‡ç‚¹'}
        ];
        const vehicle1007EndPoint = [{x: 33.85, y: -42.97, label: 'ç»ˆç‚¹', direction: 'åˆ°è¾¾äº¤æ±‡ç‚¹'}];
        
        // äº¤æ±‡ç‚¹
        const intersectionPoint = [{x: 33.85, y: -42.97, label: 'äº¤æ±‡ç‚¹', direction: 'ä¸¤è½¦äº¤æ±‡å¤„'}];
        
        // ä¸ºäº†æ˜¾ç¤ºç®­å¤´æ–¹å‘ï¼Œåˆ›å»ºæ–¹å‘æŒ‡ç¤ºæ•°æ®
        const vehicle1010Arrows = [
            {x: 40.58, y: -35.43, label: 'â†’', direction: 'å‰è¿›æ–¹å‘'},  // ä¸­ç‚¹ç®­å¤´
            {x: 53.72, y: -20.88, label: 'â†’', direction: 'å‰è¿›æ–¹å‘'}   // åæ®µç®­å¤´
        ];
        
        const vehicle1007Arrows = [
            {x: 11.75, y: -3.12, label: 'â†’', direction: 'å‰è¿›æ–¹å‘'},   // ç¬¬ä¸€æ®µç®­å¤´
            {x: 29.34, y: -10.10, label: 'â†’', direction: 'å‰è¿›æ–¹å‘'},  // ç¬¬äºŒæ®µç®­å¤´
            {x: 39.37, y: -22.66, label: 'â†’', direction: 'å‰è¿›æ–¹å‘'},  // ç¬¬ä¸‰æ®µç®­å¤´
            {x: 37.20, y: -37.49, label: 'â†’', direction: 'å‰è¿›æ–¹å‘'}   // ç¬¬å››æ®µç®­å¤´
        ];
        
        const ctx = document.getElementById('trajectoryChart').getContext('2d');
        
        const chart = new Chart(ctx, {
            type: 'scatter',
            data: {
                datasets: [
                    // è½¦è¾†1010è½¨è¿¹çº¿
                    {
                        label: 'è½¦è¾†1010è½¨è¿¹',
                        data: [...vehicle1010StartPoint, ...vehicle1010MiddlePoints, ...vehicle1010EndPoint],
                        backgroundColor: 'transparent',
                        borderColor: '#4472C4',
                        borderWidth: 4,
                        pointRadius: 0,
                        showLine: true,
                        tension: 0.3,
                        order: 10
                    },
                    // è½¦è¾†1010èµ·ç‚¹
                    {
                        label: 'è½¦è¾†1010èµ·ç‚¹',
                        data: vehicle1010StartPoint,
                        backgroundColor: '#4472C4',
                        borderColor: '#2E5A87',
                        borderWidth: 3,
                        pointRadius: 12,
                        pointStyle: 'rect',
                        pointHoverRadius: 15,
                        showLine: false,
                        order: 1
                    },
                    // è½¦è¾†1010ä¸­é—´ç‚¹
                    {
                        label: 'è½¦è¾†1010è·¯å¾„ç‚¹',
                        data: vehicle1010MiddlePoints,
                        backgroundColor: '#4472C4',
                        borderColor: '#2E5A87',
                        borderWidth: 2,
                        pointRadius: 8,
                        pointStyle: 'circle',
                        pointHoverRadius: 12,
                        showLine: false,
                        order: 2
                    },
                    // è½¦è¾†1010ç»ˆç‚¹
                    {
                        label: 'è½¦è¾†1010ç»ˆç‚¹',
                        data: vehicle1010EndPoint,
                        backgroundColor: '#4472C4',
                        borderColor: '#2E5A87',
                        borderWidth: 3,
                        pointRadius: 12,
                        pointStyle: 'triangle',
                        pointHoverRadius: 15,
                        showLine: false,
                        order: 1
                    },
                    // è½¦è¾†1010æ–¹å‘ç®­å¤´
                    {
                        label: 'è½¦è¾†1010æ–¹å‘',
                        data: vehicle1010Arrows,
                        backgroundColor: '#6C8EBF',
                        borderColor: '#4472C4',
                        borderWidth: 2,
                        pointRadius: 6,
                        pointStyle: 'triangle',
                        rotation: 45,
                        pointHoverRadius: 10,
                        showLine: false,
                        order: 3
                    },
                    
                    // è½¦è¾†1007è½¨è¿¹çº¿
                    {
                        label: 'è½¦è¾†1007è½¨è¿¹',
                        data: [...vehicle1007StartPoint, ...vehicle1007MiddlePoints, ...vehicle1007EndPoint],
                        backgroundColor: 'transparent',
                        borderColor: '#E74C3C',
                        borderWidth: 4,
                        pointRadius: 0,
                        showLine: true,
                        tension: 0.3,
                        order: 10
                    },
                    // è½¦è¾†1007èµ·ç‚¹
                    {
                        label: 'è½¦è¾†1007èµ·ç‚¹',
                        data: vehicle1007StartPoint,
                        backgroundColor: '#E74C3C',
                        borderColor: '#C0392B',
                        borderWidth: 3,
                        pointRadius: 12,
                        pointStyle: 'rect',
                        pointHoverRadius: 15,
                        showLine: false,
                        order: 1
                    },
                    // è½¦è¾†1007ä¸­é—´ç‚¹
                    {
                        label: 'è½¦è¾†1007è·¯å¾„ç‚¹',
                        data: vehicle1007MiddlePoints,
                        backgroundColor: '#E74C3C',
                        borderColor: '#C0392B',
                        borderWidth: 2,
                        pointRadius: 8,
                        pointStyle: 'circle',
                        pointHoverRadius: 12,
                        showLine: false,
                        order: 2
                    },
                    // è½¦è¾†1007ç»ˆç‚¹
                    {
                        label: 'è½¦è¾†1007ç»ˆç‚¹',
                        data: vehicle1007EndPoint,
                        backgroundColor: '#E74C3C',
                        borderColor: '#C0392B',
                        borderWidth: 3,
                        pointRadius: 12,
                        pointStyle: 'triangle',
                        pointHoverRadius: 15,
                        showLine: false,
                        order: 1
                    },
                    // è½¦è¾†1007æ–¹å‘ç®­å¤´
                    {
                        label: 'è½¦è¾†1007æ–¹å‘',
                        data: vehicle1007Arrows,
                        backgroundColor: '#F1948A',
                        borderColor: '#E74C3C',
                        borderWidth: 2,
                        pointRadius: 6,
                        pointStyle: 'triangle',
                        rotation: 225,
                        pointHoverRadius: 10,
                        showLine: false,
                        order: 3
                    },
                    
                    // äº¤æ±‡ç‚¹
                    {
                        label: 'äº¤æ±‡ç‚¹',
                        data: intersectionPoint,
                        backgroundColor: '#27AE60',
                        borderColor: '#1E8449',
                        borderWidth: 4,
                        pointRadius: 16,
                        pointStyle: 'star',
                        pointHoverRadius: 20,
                        showLine: false,
                        order: 0
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'è½¦è¾†è½¨è¿¹åæ ‡å›¾ - å«èµ·ç‚¹ç»ˆç‚¹åŠå‰è¿›æ–¹å‘ (åŸºäº2025-06-25æ—¥å¿—æ•°æ®)',
                        font: {
                            size: 16,
                            weight: 'bold'
                        }
                    },
                    legend: {
                        display: true,
                        position: 'top',
                        labels: {
                            usePointStyle: true,
                            font: {
                                size: 11
                            },
                            filter: function(item, chart) {
                                // åªæ˜¾ç¤ºä¸»è¦çš„å›¾ä¾‹é¡¹ï¼Œéšè—æ–¹å‘ç®­å¤´å’Œè¾…åŠ©çº¿
                                return !item.text.includes('æ–¹å‘') && !item.text.includes('è½¨è¿¹') && !item.text.includes('è·¯å¾„ç‚¹');
                            }
                        }
                    },
                    tooltip: {
                        callbacks: {
                            title: function(context) {
                                const datasetLabel = context[0].dataset.label;
                                const pointData = context[0].raw;
                                let title = `${datasetLabel}`;
                                if (pointData.label) {
                                    title += ` - ${pointData.label}`;
                                }
                                return title;
                            },
                            label: function(context) {
                                const pointData = context.raw;
                                let labels = [`åæ ‡: (${context.parsed.x}, ${context.parsed.y})`];
                                if (pointData.direction) {
                                    labels.push(`æ–¹å‘: ${pointData.direction}`);
                                }
                                return labels;
                            }
                        },
                        displayColors: true,
                        backgroundColor: 'rgba(0,0,0,0.8)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        borderColor: '#333',
                        borderWidth: 1
                    }
                },
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'X åæ ‡',
                            font: {
                                size: 14,
                                weight: 'bold'
                            }
                        },
                        grid: {
                            color: 'rgba(0,0,0,0.1)'
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Y åæ ‡',
                            font: {
                                size: 14,
                                weight: 'bold'
                            }
                        },
                        grid: {
                            color: 'rgba(0,0,0,0.1)'
                        }
                    }
                },
                interaction: {
                    intersect: false,
                    mode: 'point'
                },
                onHover: function(event, activeElements) {
                    event.native.target.style.cursor = activeElements.length > 0 ? 'pointer' : 'default';
                }
            }
        });
        
        // æ·»åŠ ç‚¹å‡»äº‹ä»¶æ¥æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
        ctx.addEventListener('click', function(event) {
            const points = chart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);
            if (points.length) {
                const point = points[0];
                const datasetIndex = point.datasetIndex;
                const index = point.index;
                const data = chart.data.datasets[datasetIndex].data[index];
                const label = chart.data.datasets[datasetIndex].label;
                
                let message = `${label}\nåæ ‡: (${data.x}, ${data.y})`;
                if (data.label) {
                    message += `\nç±»å‹: ${data.label}`;
                }
                if (data.direction) {
                    message += `\næ–¹å‘: ${data.direction}`;
                }
                
                alert(message);
            }
        });
    </script>
</body>
</html>